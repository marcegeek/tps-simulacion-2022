\begin{abstract}
  En este trabajo estudiaremos dos modelos de simulación de eventos discretos, el primero es el comportamiento
  de líneas de espera. El cual es de gran ayuda para predecir el comportamiento de dichas lineas en
  situaciones del mundo real, desde la entrada y salida de autos de un estacionamiento hasta la utilización
  de una red distribuida de servidores a lo largo del mundo que alojan una página web para miles de usuarios.
  El siguiente será un modelo de inventario que nos permitirá saber los costos correspondientes al mantenimiento
  o de compras necesarias y será de gran ayuda para un inventario en la vida real
\end{abstract}


\section{Introducción}\label{sec:introduccion}
En el siguiente trabajo simularemos mediante un programa desarrollado en lenguaje Python, una cola simple, en la que
solamente habrá llegada de clientes, atendidos por un único servidor luego de haber realizado una espera
determinada en la cola y posteriormente partirán.
Adicionalmente se simulará una cola con una cantidad de servidores predeterminada.
El modelo de inventario contará con el mismo formato y consistirá en un proceso por mes en el que se realiza una orden de compra
a los proveedores, mientras se trata de alcanzar la demanda de los clientes a través de distintos indicadores de escacez y
existencia.
Finalmente se realizará una evaluación y se calcularán las estadísticas correspondientes.
A su vez estudiaremos la eficacia de dichos programas al comparar ciertas medidas de rendimiento observadas con las
teóricas computadas y a su vez con las obtenidas mediante una calculadora web, y de otra simulación desarrollada
en el aplicativo Anylogic.


\section{Marco teórico}\label{sec:marco-teórico}

\subsection{Proceso Estocástico}\label{subsec:proceso-estocástico}
En la teoría de la probabilidad, un proceso estocástico es un concepto matemático que sirve para representar
magnitudes aleatorias que varían con el tiempo o para caracterizar una sucesión de variables aleatorias (estocásticas)
que evolucionan en función de otra variable, generalmente el tiempo.
Cada una de las variables aleatorias del proceso tiene su propia función de distribución de probabilidad y pueden o no
estar correlacionadas entre sí.

Cada variable o conjunto de variables sometidas a influencias o efectos aleatorios constituye un proceso estocástico.
Un proceso estocástico Xt puede entenderse como una familia uniparamétrica de
variables aleatorias indexadas mediante el tiempo t.
Los procesos estocásticos permiten tratar procesos dinámicos en los que hay cierta aleatoriedad.


\section{Modelo M/M/1}\label{sec:modelo-m/m/1}
Un sistema de espera M/M/1 es aquel que considera un servidor, con tiempos exponenciales de servicio y entre llegadas
de clientes. La implicancia que los tiempos de servicio se distribuyan exponencial es que existe una preponderancia de
tiempos de servicio menores al promedio combinados con algunos pocos tiempos extensos. Un ejemplo de ello es lo que
sucede en las cajas de los bancos donde la mayoría de las transacciones requieren poco tiempo de proceso por parte del
cajero, no obstante algunas transacciones más complejas consumen bastante tiempo. Por otra parte afirmar que los tiempos
entre llegadas se distribuyen exponencial implica una preponderancia de tiempos entre llegadas menores que el promedio
en combinación con algunos tiempos más extensos. Lo anterior tiene relación con la aleatoriedad del proceso de llegada
de clientes que permite establecer la Propiedad de Falta de Memoria o Amnesia de la Distribución Exponencial y
con los conceptos presentados en el artículo Qué son las Líneas de Espera (Teoría de Colas), donde queda en evidencia
que la formación de las colas o filas esta asociada a la variabilidad del sistema.

En este contexto consideremos la siguiente notación, donde valores usuales para A y B son M (distribución exponencial)
y G (distribución general).

En el estudio con colas simples, cuya notación de Kendalls son M/M/1, para la primera, donde se posee un sólo serivor,
las distribuciones de arribo y de servicio proceden de manera Markoviana y su cola es infinita, y en el caso de la
siguientes M/M/C dónde solamente se añadiran mas servidores.
Para la distribución de arribos, se tiene un parámetro λ, la tasa de arribos de clientes, de él obtenemos la media de
clientes entrantes por unidad de tiempo 1/λ.
Por otro lado, la tasa de tiempo de serivicios µ y la media de tiempos de servicios 1/ µ.
A partir de estos dos parámetros, obtenemos la tasa de utilización del servidor ρ = 1/sµ, la relación entre los clientes
arribando y los clientes partiendo, siendo s el número de servidores, en nuestro caso s = 1 (luego se permitira variarlo).
Como la llegada de clientes y su tiempo en ser servidos son variables aleatorias, se pueden considerar
nuevas variables aleatorias, que son combinaciones lineales de las anteriores, por ejemplo:

Considere un sistema de colas de un solo servidor para el cual el intervalo entre llegadas son A1, A2, . . . veces con
variables aleatorias independientes e idénticamente distribuidas.

A partir de una única ejecución de la simulación con retrasos de los clientes D1, D2, . . . , Dn, es obvio que el
estimador de d(n) es:

\begin{equation} \label{eq:equation}
\hat{d}(n) = \frac{\sum_{i = 1}^{n}D_{i}}{n}
\end{equation}
que es solo el promedio de los Di's que se observaron en la simulación.

Una de las medidas para nuestro modelo simple es el número promedio esperado de clientes en la cola (pero sin
ser servida), denotada por q(n), donde la n es necesaria en la notación para indicar que este promedio se
toma durante el período de tiempo necesario para observar los n retrasos que definen
nuestra regla de parada.
Este es un tipo diferente de "promedio" a comparación del retraso promedio en cola, porque se toma el tiempo
(continuo), en lugar de los clientes (siendo este discreto).
Por lo tanto, necesitamos definir qué significa este número promedio de tiempo de
clientes en cola.
Para hacer esto, sea Q(t) el número de clientes en cola en el tiempo t, para cualquier número real t>=0 ,
y sea T(n) el tiempo requerido para observar nuestros n retrasos en la cola.
Entonces para cualquier tiempo t entre 0 y T(n), Q(t) es un entero no negativo. Además, si dejamos que pi sea la
proporción esperada (que estará entre 0 y 1) del tiempo que Q(t) es igual a i, entonces una definición
razonable de q(n) sería:
 \begin{equation}
   \label{eq:equation2}
q(n) = \sum_{i=0}^{\infty}ip_{i}
 \end{equation}
Por lo tanto, q(n) es un promedio ponderado de los posibles valores de i para la longitud de la cola Q(t),
siendo las áreas la proporción esperada de tiempo que la cola pasa en cada uno de sus posibles longitudes.
Para estimar q(n) a partir de una simulación, simplemente reemplazamos los pi con estimaciones de ellos y
obtenemos:
\begin{equation}
  \label{eq:equation3}
  \hat{q}(n) = \sum_{i=0}^{\infty}i\hat{p}_{i}
\end{equation}
donde \hat{p}i es la proporción observada (en lugar de la esperada) del tiempo durante la simulación
donde que había i clientes en la cola.
Computacionalmente, sin embargo, es más fácil reescribir \hat{q}(n) usando algunas consideraciones geométricas.
Si dejamos que Ti sea el total de tiempo durante la simulación donde la cola tiene una longitud i, entonces
T(n) = T0 + T1 + T2 + ∙ ∙ ∙ y \hat{p}i = Ti/T(n), por lo que podemos reescribir la ecuación 1.1 como:

\begin{equation}
  \label{eq:equation4}
\hat{q}(n)=\frac{\sum_{i=0}^{\infty}iT_{i} }{T(n)}
\end{equation}

El numerador de la ecuación anterior, representa el área bajo la función Q(t):
\begin{equation}
  \label{eq:equation5}
  \sum_{i=0}^{k-1}iT_{i} = \int_{0}^{T(n)}Q(t)dt
\end{equation}
Reemplazándolo en la ecuación anterior, nos queda:

\begin{equation}
  \label{eq:equation6}
  \hat{q}(n)=\frac{\int_{0}^{T(n)}Q(t)dt }{T(n)}
\end{equation}
Esta integral puede ser calculada como la suma de rectángulos formados por la base tiempo de cierta cantidad
de clientes en cola por la altura dicha cantidad de clientes en cola.

La proporción esperada de tiempo del servidor en estado ocupado u(n), deviene de la probabilidad de que
el servidor no esté vacío, pN>0 = 1 − p0. Para calcular su estimador u(n), primero se define la "función
ocupada":

\begin{equation}\label{eq:equation7}
  B(t)\left\{ \begin{array}{lcc}
                  1 &   si  & Nt>0  \\
                  \\ 0 &  si  & Nt=0
  \end{array}
  \right
\end{equation}

Entonces u(n) es la porción del tiempo total en la que B(t) = 1.
Al igual que a la medida anterior, podemos considerarlo como el área bajo B(t), así,
\begin{equation}\label{eq:equation8}
\hat{u}(n)=\frac{\int_{0}^{T(n)}B(t)}{T(n)}
\end{equation}
En definitiva, u(n) es la sumatoria de áreas rectangulares, donde la base es el tiempo en el que el servidor
está en un estado específico, y la altura es dicho estado, 0 o 1.

\section{Modelo de Inventario}\label{sec:modelo-m/m/c}
Los inventarios están presentes en todas las compañías que tratan con productos físicos,
tales como fabricantes, distribuidores, comerciantes, etc.
Las empresas necesitan inventarios de materias primas para la manufactura de productos y a su vez
deben almacenar productos terminados en el almacén a la espera de ser vendidos.
De manera similar, los distribuidores deben mantener inventarios de bienes que deberán estar
disponibles cuando los consumidores los necesiten.
Dado que los stocks representan una cantidad de dinero inmovilizada muy importante dentro
de una empresa, la reducción de los costos de almacenamiento (evitando inventarios
innecesariamente grandes) podría mejorar la competitividad de cualquier sistema
productivo.

Cuando hay que analizar los inventarios con una demanda independiente los modelos de
gestión de stocks que se utilizan son: el modelo de cantidad fija del pedido (EOQ) y el
modelo de periodo de tiempo fijo (también llamado de revisión periódica, modelo P) [1-2].
En el modelo de cantidad fija de pedido se coloca un pedido cuando el inventario restante cae a
un punto de pedido y se revisa el nivel de inventario continuamente.
De esta manera, el modelo de cantidad fija de pedido es un sistema perpetuo que requiere que cada
vez que se haga un retiro o una adición al inventario, los registros deban actualizarse para
asegurar que el punto del nuevo pedido se ha alcanzado o no.
En cambio en el modelo de periodo de
tiempo fijo, el conteo tiene lugar solo durante el periodo de revisión.

Suponiendo una empresa que vende un solo producto le gustaría decidir cuántos artículos debería
tener en inventario para cada uno de los siguientes n meses (n es un parámetro de entrada fijo).
Los tiempos entre demandas son variables aleatorias exponenciales con una media de 0,1 mes.
Los tamaños de las demandas, D, son variables aleatorias IID (independientes de cuando se presentan
las demandas), con:
\begin{equation}
  \label{eq:equation9}
  D=\left\{ \begin{array}{lcc}
            1 &   c.p.  & 1/6 \\
            \\ 2 &  c.p. & 1/3 \\
            \\ 3 &  c.p. & 1/3 \\
            \\ 4 &  c.p.  & 1/6
  \end{array}
  \right
\end{equation}
donde c.p. significa "Con Probabilidad de".

Al comienzo de cada mes, la empresa revisa el nivel de inventario y decide cuántos artículos pedir
a su proveedor.
Si la empresa ordena Z artículos, incurre en un costo de K + iZ, donde K = \$32 es el costo de
preparación e i = \$3 es el incremento coste incremental por artículo pedido.
(Si Z = 0, no incurre ningún costo).
Cuando se realiza un pedido, el tiempo requerido para que llegue (llamado retraso en la entrega
o tiempo de entrega) es una variable aleatoria que se distribuye uniformemente entre 0,5 y 1 mes.

La empresa utiliza una política estacionaria (s, S) para decidir cuánto pedir, es decir,
\begin{equation}
  \label{eq:equation10}
  Z = \left\{ \begin{array}{lcc}
                S-I & if I < s \\
                \\ 0 & if I \leq s
  \end{array}
  \right.
\end{equation}
donde I es el nivel de inventario al comienzo del mes.

Para nuestro modelo, supondremos que la empresa incurre en un costo de mantenimiento de
h = \$1 por artículo por mes mantenido en el inventario (positivo).
El costo de mantenimiento incluye costos tales como alquiler de almacenes, seguros, impuestos
y mantenimiento, así como el costo de oportunidad de tener capital inmovilizado en el inventario
en lugar de invertirlo en otra parte.
Hemos ignorado en nuestra formulación el hecho de que todavía se incurre en algunos costos de
mantenimiento cuando I = 0.
Sin embargo, dado que nuestro objetivo es comparar las políticas de pedido, ignorar este factor,
que después de todo es independiente de la política utilizada, no afectará nuestra evaluación
de qué política es la mejor.
Ahora, dado que I es el número de elementos retenidos en el inventario en el momento t,
la cantidad promedio de tiempo (por mes) de artículos mantenidos en el inventario durante el
período de n meses es
\begin{equation}
  \label{eq:equation11}
  \bar{I}^{+}=\frac{\int_{0}^{n}I^{+}(t)dt}{n}
\end{equation}

De manera similar, suponga que la compañía incurre en un costo de trabajo pendiente de p = \$5 por
artículo por mes en reserva;
esto representa el costo del mantenimiento adicional de activos cuando existe acumulación de pedidos,
así como pérdida de la buena voluntad de los clientes.
El número promedio de tiempo de los elementos en la reserva es:
\begin{equation}
    \label{eq:equation12}
    \bar{I}^{-}=\frac{\int_{0}^{n}I^{-}(t)dt}{n}
\end{equation}
por lo que el costo promedio de la cartera de pedidos por mes es \pi I.

\section{Análisis de resultados}

    \input{anylogic-colas.tex}

\subsection{Modelo de Inventario en AnyLogic}
\label{subsec:modelo-de-inventario-en-anylogic}
    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/anylogic-inventario}
        \caption{Modelo de Inventario con sus parámetros,variables y eventos utilizados en Anygic.}
    \end{figure}

    Como podemos ver, hay ciertos parámetros que ya hemos utilizados en el modelo realizado en Python, pero fué necesario además agregar nuevos para poder utilizarlos con distintas funcionalidades.

    Comenzando por el evento "Ordering" el cual nos permite programar los reabastecimientos del inventario a través de dos parámetros: (demand y order quantity). Además agregamos una variable llamada invetoryLevel la cual analizaremos con una linea de tiempo.

    Este es un evento cíclico con un tiempo de recurrencia de un día.

    Suponiendo que la demanda diaria y/o el tiempo de entrega se distribuyen normalmente.
    Necesitamos definir más  parámetros para el tiempo de entrega, la demanda media, el tiempo de entrega promedio, la desviación estándar de la demanda y la desviación estándar del tiempo de entrega.

    Para el sistema de revisión periódica, reabastecemos en fechas fijas, por lo que solo modificamos el tiempo de recurrencia del evento “Ordering” definiéndolo a través del parámetro "t\_period".

    Para el sistema de revisión continua, la regla de reabastecimiento se puede definir con la ayuda del punto de pedido (ROP).

    Además incluiremos stock de seguridad en nuestro modelo.
    Para modelar el tiempo de entrega, definimos el evento "NewOrder" y la variable "OrderReceived de tipo "Booleano" (con valor inicial "false") y vuelva a escribir la regla de reposición en el evento "Ordering".

    Si el nivel de inventario alcanza el punto de pedido, se genera un nuevo pedido de reabastecimiento el cual llegará en X días definidos en el parámetro LeadTime.
    Es por eso que dejamos que el evento "NewOrder" comience en X días.
    En el momento de la entrada del pedido y el aumento del nivel de inventario, la variable lógica "OrderReceived" toma el valor "false". Esto significa que no hay otras órdenes
    recibidas por nuestro proveedor.
    El siguiente pedido se generará cuando el nivel de inventario vuelva a alcanzar el punto de pedido.

    Para estimar la eficiencia de las diferentes políticas de pedidos, necesitamos estimar los costos de mantenimiento de inventario, pedidos y agotamiento de existencias.
    Primero, se necesitan nuevos parámetros y variables para estos tres tipos de costos. En segundo lugar, los diagramas deben construirse como gráficos de barras y diagramas de tiempo.
    Definimos tres nuevos parámetros “HoldingCost”, “OrderingCost” y “StockoutCosts” y tres nuevas variables de los mismos. Es necesario definir otras tres nuevas variables, "ServiceLevel", "TotalSales" y "RetailShortage".

    Los costos, la escasez y el nivel de servicio se actualizan en el evento "CostsUpdate".

    A continuación se realizarán 10 simulaciones de 30 días cada una, donde se llevarán a cabo las mediciones de las siguientes variables:
    \begin{itemize}
        \item Costo de Orden
        \item Costo de Mantenimiento
        \item Costo de Faltante
        \item Costo Total
    \end{itemize}

    A continuación se presentarán algunas simulaciones por parte del sistema creado y luego veremos una tabla comparativa con los resultados de las variables analizadas:
    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img1invent}
        \caption{Simulación 1. Orden de compra alto.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img2invent}
        \caption{Simulación 2. Orden de compra y ROP bajo.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img3invent}
        \caption{Simulación 3. Cantidad inicial alta y ROP a un tercio de la cantidad inicial.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img4invent}
        \caption{Simulación 4. Gran falta de stock.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img5invent}
        \caption{Simulación 5. Gran falta de stock con mayor velocidad de recepción.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img6invent}
        \caption{Simulación 6. Mismo Escenario con mayor cantidad de demanda.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img7invent}
        \caption{Simulación 7. Mismo Escenario con mayor cantidad de orden de compra.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img8invent}
        \caption{Simulación 8. Baja demanda.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img9invent}
        \caption{Simulación 9. Baja demanda y aumento de ROP.}
    \end{figure}

    \begin{figure}[H]
        \includegraphics[width=\linewidth]{images/img9invent}
        \caption{Simulación 10. Disminución de orden de compra.}
    \end{figure}

    \begin{tabular}{||c||c|c|c|c||}
        \hline \hline
        Simulación nro & Orden & Mantenimiento & Faltante & TOTAL\\
        \hline \hline
        1 & $60$ & $486,7$ & $0$ & $546,7$\\
        \hline
        2 & $40$ & $34,8$ & $60,4$ & $135,2$\\
        \hline
        3 & $60$ & $285,5$ & $0$ & $345,5$\\
        \hline
        4 & $40$ & $0$ & $190,8$ & $230,8$\\
        \hline
        5 & $100$ & $0$ & $204,4$ & $304,4$\\
        \hline
        6 & $100$ & $2,6$ & $155,2$ & $257,8$\\
        \hline
        7 & $100$ & $52,7$ & $389,2$ & $541,9$\\
        \hline
        8 & $100$ & $66,1$ & $37,2$ & $203,3$\\
        \hline
        9 & $100$ & $138,9$ & $0$ & $238,9$\\
        \hline
        10 & $100$ & $124,4$ & $0$ &$224,4$\\
        \hline \hline
    \end{tabular}

    \subsubsection{Conclusion de las simulaciones}\label{subsubsec:conclusiones}
    Cabe aclarar que los resultados negativos no significan que se "ahorró" el costo, esto cuenta como 0 debido a que no se pudo realizar el costo de mantenimiento del stock ya que hubo faltante del mismo.
    Además se puede observar como en la simulación 2 fué la que más pudo mantener bajos costos a comparación de las demás debido a que tuvo pocas ordenes de compra y una gran existencia al principio.

    La Simulación 8 fué la siguiente con menos costo debido a que si bien tuvo muchos gastos en las ordenes de compra, pudo distribuir mejor la faltante y el mantenimiento de la existencia en el inventario.

    A su vez la Simulación 1 fué la más costosa, debido a que mantuvo una gran cantidad de stock en el inventario mientras que la segunda mas costosa (la simulación 7) tuvo el mismo problema con la diferencia de que esta que tuvo mucha faltante.

    Como conclusión se puede decir que el mayor problema radica en la falta de equilibrio en los costos de cada acción, ya que por ejemplo se pueden tener altos costos de orden de compra, pero esto no fué problema para la simulación 8 que distribuyó la faltante y el mantenimiento de existencia de manera que pudo reducir los costos.
    De la misma manera, hubo simulaciones con pocas ordenes de compra pero con altos costes de faltante o de mantenimiento, lo que llevo a grandes costos totales.


\section{Conclusiones}
\section{Referencias}
  \label{sec:references}
    https://es.wikipedia.org/wiki/Proceso\_estoc%C3%A1stico#:~:text=En%20la%20teor%C3%ADa%20de%20la,otra%20variable%2C%20generalmente%20el%20tiempo.

    Arash Mahdavi, Simulation Modeling Consultant, The AnyLogic Company M/M/1/∞/∞ (single-server
    queues). En The Art of Process-Centric Modeling with AnyLogic, pages 81–103. 2020. Disponible en https://www.anylogic.com/resources/books/the-art-of-process-centric-modeling-with-anylogic/

    Averill M. Law, W. David. Kelton Simulation of a single-server queueing system. En Simulation Modeling Analysis,
    pages 13–74. 199
